#@ load("@ytt:data", "data")
#@ load("@ytt:base64", "base64")
#@ load("@ytt:json", "json")

#@ if data.values.tap.devNamespace != "default" and data.values.tap.devNamespace != "":
---
apiVersion: v1
kind: Namespace
metadata:
  name: #@ data.values.tap.devNamespace
---
#@ def config():
#@  return {
#@    "auths": {
#@      data.values.tap.registry.host: {
#@        "username": data.values.tap.credentials.registry.username,
#@        "password": data.values.tap.credentials.registry.password
#@      }
#@    }
#@  }
#@ end
---
apiVersion: v1
kind: Secret
metadata:
  name: registry-credentials
  namespace: #@ data.values.tap.devNamespace
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: #@ json.encode(config())
---
apiVersion: v1
kind: Secret
metadata:
  name: tap-registry
  namespace: #@ data.values.tap.devNamespace
  annotations:
    secretgen.carvel.dev/image-pull-secret: ""
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: e30K
---
#! secret for supply chain gitops
apiVersion: v1
kind: Secret
metadata:
  name: git-ssh
data:
  identity: LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUNGd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFnRUF3LzRZNUNvcjdwRXJsTitrZGpFR0tRVEdSRGE1bFFXczZIb1hoYWRYcFRFdXF6UDMzTjAwCmhaVnY2MklKWWFodjZoUEJTVFMzdlNvbXUyMHJXay9GcG9Ib1NuL1V0NlRNdTM3MnJ4cGlQb09md1Irby9TSGczamtkeDgKRzB1Y2J1Y21RU1NSTStyZjBNd1B3R3pXdEI4N1Y3UWlOanJIMVNtWlJFdWEzTEQ3bXVCT2EwL0t5TW8wZ0xWL3dnNytFbgpOQWdJSkRyVXljUUdrTGxOWU8yU1FPVHZ3K0gySlNyT3diZkRML1Jvcm1OeEkwK1U5R0JGQ0lQTkhaN2NJTVBPYTIxQ2ZkCnRPVElNWWtST0c1NG1hZ2tnVTJEeTk0TEtUVmQwWVhRbU5xbHFuUmRId0xpU0l1dmNrSU9RdUZpQnJTM2ErbmE2OXJZMGIKNklKdkNJUXhOVjJMbHlrNDl5aWt3NTJmSStteTM1bGhDSTBIR1l0STdNeG5GL3Y0TU9maWNHUFU4enJvT2VoR3RGS2l0ZApqQ3BJTFZ2TGtGMU9kL2lpc1JVY0Q3L0d2emZXVDR1cS9KdnRlVFQzSEw0bWlkanliVjNjd0l3U0Y5KzBQVnRpdlR5KzZVClpmZlp3dFNZS3VXQ1Z5RE1QK2tSOVFPa2hRbnVVQklnMU9zTUxXUlM0WXF4cDNlY1hUN1VTem9GWnMvamh1emVTaHEyakkKQUU0QSsvZjBncG1FNUFDdTlvM3BLZkQxU2Z2TnQraWp1SEdMWkhKMDRid2RNZlNLdjhLcXZveVBLbTA5QnhobnpZZzZMSwpiN2NVK0tpVHRBTlIzSFBSMFhPWE1tOVRTbG9MMk5BdU04ZzMrS3RPclZkQ2ZKNldjbmZUZmtoSUZaTFJUOG5PeUhnREpXCjhBQUFkUWZ6SVBwWDh5RDZVQUFBQUhjM05vTFhKellRQUFBZ0VBdy80WTVDb3I3cEVybE4ra2RqRUdLUVRHUkRhNWxRV3MKNkhvWGhhZFhwVEV1cXpQMzNOMDBoWlZ2NjJJSllhaHY2aFBCU1RTM3ZTb211MjByV2svRnBvSG9Tbi9VdDZUTXUzNzJyeApwaVBvT2Z3UitvL1NIZzNqa2R4OEcwdWNidWNtUVNTUk0rcmYwTXdQd0d6V3RCODdWN1FpTmpySDFTbVpSRXVhM0xEN211CkJPYTAvS3lNbzBnTFYvd2c3K0VuTkFnSUpEclV5Y1FHa0xsTllPMlNRT1R2dytIMkpTck93YmZETC9Sb3JtTnhJMCtVOUcKQkZDSVBOSFo3Y0lNUE9hMjFDZmR0T1RJTVlrUk9HNTRtYWdrZ1UyRHk5NExLVFZkMFlYUW1OcWxxblJkSHdMaVNJdXZjawpJT1F1RmlCclMzYStuYTY5clkwYjZJSnZDSVF4TlYyTGx5azQ5eWlrdzUyZkkrbXkzNWxoQ0kwSEdZdEk3TXhuRi92NE1PCmZpY0dQVTh6cm9PZWhHdEZLaXRkakNwSUxWdkxrRjFPZC9paXNSVWNENy9HdnpmV1Q0dXEvSnZ0ZVRUM0hMNG1pZGp5YlYKM2N3SXdTRjkrMFBWdGl2VHkrNlVaZmZad3RTWUt1V0NWeURNUCtrUjlRT2toUW51VUJJZzFPc01MV1JTNFlxeHAzZWNYVAo3VVN6b0Zacy9qaHV6ZVNocTJqSUFFNEErL2YwZ3BtRTVBQ3U5bzNwS2ZEMVNmdk50K2lqdUhHTFpISjA0YndkTWZTS3Y4Cktxdm95UEttMDlCeGhuellnNkxLYjdjVStLaVR0QU5SM0hQUjBYT1hNbTlUU2xvTDJOQXVNOGczK0t0T3JWZENmSjZXY24KZlRma2hJRlpMUlQ4bk95SGdESlc4QUFBQURBUUFCQUFBQ0FRQ1lNVm1NMi82UFcrVjJ6bys4UStkZnROaHRJZjNNYmNMTwpKL2phRFk5dXRKbGowcEFYenlJNDFVazZoRDk2dVR4bWpYNmJaVGVFeWhXWGwzZUJ3czVkdFNUM3JQbzJ2TjlLZlpYN2RVClp5K3V6MEg2eXZIRDZzOGJkaFpkYjhLREVEWFJnaDdMTFFrdDd6Z1FHYlJEM0xqTkt4RWlBVlVwL3dxSVVSbHBaSG1NMDcKK3hieDJ0Kys3M1AzbDg3UDE0d0V5SFBpQmxrMGNHY1V2UUFNVTQ4dG0xbGdSN2hITmsybGVoZzB4ZHNBQ0RKVDFEbDc1cwpIVWtkeVdzc1NISU9YSzMrWXhLenBMQ2NYcTZqbm8xQjdLS2tVZGdWV0ZCY2FKZDQyeXVYZHJvTWVoM1J0Z0NYaXZqcmhjClhqUTNkR2M5QzNHTHFxU1oveWg3emNXQTNINEVjYlFGOGs1WnBCd3B2Z3NzZ29wN09KNThrZGNQV1pFbno0YllZTkNablUKR2h4aTF6ZmM4aHBWbVFzNDNsOEw3Y28xN1hwZHZyOEhZWFBVc0lIS1duVE1hWEZObWZsaXlkOUl6amo2NXFGOTFSYzRMcgp1K1FNbXZJRDU2OXJnZTdWQVQzMk8zSDRKdU9PMDFVZG5pWUtNT3RUNmVyY1RaNngwdzhxbXE0MSt2bWdHTVo5ZFNrRnZUClUwS1V2NTR4dHYvbXVTUkZrK3dQeCtzRS9EbmRUQXllTXo4TUlwN3RGUGtSQ2NyYUJ0Z0VOZHMwQnlZRVlDU29IQUIwZG4KUHNHeGpPeVhXenhHU1dJWk5NT0tpT3R6SllleXMrMTg0UXhKMkwzc1RHajdNdzRFTEpCK0NLUFRSQVN6N2cvQ05DNWd5dgpBQTNCcUpMeW9RUUFheWZ1bWtZUUFBQVFFQWdMa0NVd283WXAydUpFZFpMZWZnQVZRZlBGMmZjZk4wOXZWMmREUXdJNHcwCklxWldDamZzb3hSa2hWTUdBUEF2RXNhU2pIb2NFSEtFTXNPc3NSZGtJY2R2d2FWdVZDcjhKV0FhZ0lQSlFjeFRHK0tXMkMKdkxYbmxndk9WSTNjMjI0bzgwekMzcUJwZ2xnbWVBcVM2cjVlQzVMQUFuWGhQeElnZGdkUm9ZWjEyVHluNzBaaWNlZUFDMgpLQ08vbkM3eXZ3cXdnUTNwMktCcWQxamEwRWFaYmQ4ckZWemcxZXUvRXFydWlPaitwVE1Vc2MzNkIySmcvMmY0VXZHVEpHCnhCd3huUDBCRnA3S216MFRKNmV5eEFZNHFQSVdXYWFmVHo3ZXBpU2VhNmdNZjZTbVYxeitJYUVwQXNwRmdxRzE4STBYSEMKYVphU1o3OVI4eDljcHcvWTBBQUFBUUVBNUc0c1Y0ekdla2NXR0JlQ29meEF3VkRDVHRMZkNsY0dFQ3hWbUs2VmYrN3VkWApjL0hUbk9sQzRqSkFkVkY2bnZHZEZyQStCY2ZXR3dBcUh2OTdnclowdjJWNmE0aElzaHJLNk1MRVAxT3pXSExmdmswZDE3Cm5RUlYyWkU2OGtFWWF5WklCTWN2Y0dKOUt5aTNWZzFyWXl1VWwyOVdhVGcxa2FGaHZCOXFhUS9tRUdZRTJVbjc4VVFaL0oKYVF1cmJWTXhoQzBvWDAvTXhJMHdsZ29aNDJJZDRHbWFCMjdSQlZnNW9aNWhUVlJQUW1vNHREWDlkUEFoZkl2d2hXcHB4UQpFRlhLR29CWkR0WHoya2hDL0VtK2lHZUhtb1FZSTRlK1pTTTVaQXFHT1o0VHFwTm1JenFiZlQyRzVNYTZXekhIZ3RMWWdxCjJmZGVhbHk4NFlXZ3lZY1FBQUFRRUEyNld4QXRGVzhkcXRqa2NzV0lqdzVNZ2pXY3dpWlNKeWlSdVRuTHY5ZjdBdm8vTm4KV0tpK0lzYjZ2bGl3SUFVNEZuVEpzQzIwd2J3NWQxcmk0Y1RiQXVlR1JTWVV5RUxkS3dBQnMxVnhZNDVkck5kQ2pWMExZYgpQRWhqd1RIQnArL3Y3OUsyMDVqMXlQU09WSzE4MEtDbzdVUVdwbHJzR1F3d3RsYmxxRUJvNkp1QnNGU21zRHB0RXo3YjhRCmhSMFFmUUVFR1NJZExFOXZiWWlta3FtaUNSd3IxLzQvRVNBZ1hsZ1NBZlZHQjd6K214RGxMZjY4SllFQUZERXVUTHd6TUwKcWsxVEFCQjBuRGI0Y2FYSXVOYkduWU1XaVR2aWxmWXhDWHhUVytSclFtRWFWYW5xQ0RtNDdWZnF4dVp3WituT01DZXhvTQp5ZTlDZTJlZkh4V0wzd0FBQUJSemNsOXpkVzVoYTNKaFFIbGhhRzl2TG1OdmJRRUNBd1FGCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=
  identity.pub: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFERC9oamtLaXZ1a1N1VTM2UjJNUVlwQk1aRU5ybVZCYXpvZWhlRnAxZWxNUzZyTS9mYzNUU0ZsVy9yWWdsaHFHL3FFOEZKTkxlOUtpYTdiU3RhVDhXbWdlaEtmOVMzcE15N2Z2YXZHbUkrZzUvQkg2ajlJZURlT1IzSHdiUzV4dTV5WkJKSkV6NnQvUXpBL0FiTmEwSHp0WHRDSTJPc2ZWS1psRVM1cmNzUHVhNEU1clQ4ckl5alNBdFgvQ0R2NFNjMENBZ2tPdFRKeEFhUXVVMWc3WkpBNU8vRDRmWWxLczdCdDhNdjlHaXVZM0VqVDVUMFlFVUlnODBkbnR3Z3c4NXJiVUo5MjA1TWd4aVJFNGJuaVpxQ1NCVFlQTDNnc3BOVjNSaGRDWTJxV3FkRjBmQXVKSWk2OXlRZzVDNFdJR3RMZHI2ZHJyMnRqUnZvZ204SWhERTFYWXVYS1RqM0tLVERuWjhqNmJMZm1XRUlqUWNaaTBqc3pHY1grL2d3NStKd1k5VHpPdWc1NkVhMFVxSzEyTUtrZ3RXOHVRWFU1MytLS3hGUndQdjhhL045WlBpNnI4bSsxNU5QY2N2aWFKMlBKdFhkekFqQklYMzdROVcySzlQTDdwUmw5OW5DMUpncTVZSlhJTXcvNlJIMUE2U0ZDZTVRRWlEVTZ3d3RaRkxoaXJHbmQ1eGRQdFJMT2dWbXorT0c3TjVLR3JhTWdBVGdENzkvU0NtWVRrQUs3Mmpla3A4UFZKKzgyMzZLTzRjWXRrY25UaHZCMHg5SXEvd3FxK2pJOHFiVDBIR0dmTmlEb3NwdnR4VDRxSk8wQTFIY2M5SFJjNWN5YjFOS1dndlkwQzR6eURmNHEwNnRWMEo4bnBaeWQ5TitTRWdWa3RGUHljN0llQU1sYnc9PSBzcl9zdW5ha3JhQHlhaG9vLmNvbQo=
  known_hosts: Z2l0aHViLmNvbSBzc2gtZWQyNTUxOSBBQUFBQzNOemFDMWxaREkxTlRFNUFBQUFJT01xcW5rVnpybTBTZEc2VU9vcUtMc2FiZ0g1Qzlva1dpMGRoMmw5R0tKbApnaXRodWIuY29tIHNzaC1yc2EgQUFBQUIzTnphQzF5YzJFQUFBQUJJd0FBQVFFQXEyQTdoUkdtZG5tOXRVRGJPOUlEU3dCSzZUYlFhK1BYWVBDUHk2cmJUclR0dzdQSGtjY0tycHAweVZocDVIZEVJY0tyNnBMbFZEQmZPTFg5UVVzeUNPVjB3emZqSUpObEdFWXNkbExKaXpIaGJuMm1VanZTQUhRcVpFVFlQODFlRnpMUU5uUEh0NEVWVlVoN1ZmREVTVTg0S2V6bUQ1UWxXcFhMbXZVMzEveU1mK1NlOHhoSFR2S1NDWklGSW1Xd29HNm1iVW9XZjluenBJb2FTakIrd2VxcVVVbXBhYWFzWFZhbDcySitVWDJCKzJSUFczUmNUMGVPelFncWxKTDNSS3JUSnZkc2pFM0pFQXZHcTNsR0hTWlh5MjhHM3NrdWEyU21WaS93NHlDRTZnYk9EcW5UV2xnNyt3QzYwNHlkR1hBOFZKaVM1YXA0M0pYaVVGRkFhUT09CmdpdGh1Yi5jb20gZWNkc2Etc2hhMi1uaXN0cDI1NiBBQUFBRTJWalpITmhMWE5vWVRJdGJtbHpkSEF5TlRZQUFBQUlibWx6ZEhBeU5UWUFBQUJCQkVtS1NFTmpRRWV6T214a1pNeTdvcEtnd0ZCOW5rdDVZUnJZTWpOdUc1Tjg3dVJnZzZDTHJibzV3QWRUL3k2djBtS1YwVTJ3MFdaMllCLysrVHBvY2tnPQo=
---

apiVersion: v1
kind: ServiceAccount
metadata:
  name: default
  namespace: #@ data.values.tap.devNamespace
secrets:
  - name: registry-credentials
imagePullSecrets:
  - name: registry-credentials
  - name: tap-registry
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: default
  namespace: #@ data.values.tap.devNamespace
rules:
- apiGroups: [source.toolkit.fluxcd.io]
  resources: [gitrepositories]
  verbs: ['*']
- apiGroups: [source.apps.tanzu.vmware.com]
  resources: [imagerepositories]
  verbs: ['*']
- apiGroups: [carto.run]
  resources: [deliverables, runnables]
  verbs: ['*']
- apiGroups: [kpack.io]
  resources: [images]
  verbs: ['*']
- apiGroups: [conventions.apps.tanzu.vmware.com]
  resources: [podintents]
  verbs: ['*']
- apiGroups: [""]
  resources: ['configmaps']
  verbs: ['*']
- apiGroups: [""]
  resources: ['pods']
  verbs: ['list']
- apiGroups: [tekton.dev]
  resources: [taskruns, pipelineruns]
  verbs: ['*']
- apiGroups: [tekton.dev]
  resources: [pipelines]
  verbs: ['list']
- apiGroups: [kappctrl.k14s.io]
  resources: [apps]
  verbs: ['*']
- apiGroups: [serving.knative.dev]
  resources: ['services']
  verbs: ['*']
- apiGroups: [servicebinding.io]
  resources: ['servicebindings']
  verbs: ['*']
- apiGroups: [services.apps.tanzu.vmware.com]
  resources: ['resourceclaims']
  verbs: ['*']
- apiGroups: [scanning.apps.tanzu.vmware.com]
  resources: ['imagescans', 'sourcescans']
  verbs: ['*']
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: default
  namespace: #@ data.values.tap.devNamespace
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: default
subjects:
  - kind: ServiceAccount
    name: default
#@ end
